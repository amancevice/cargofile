#!/usr/bin/env ruby
GEM = Gem::Specification::load("rumrunner.gemspec")
PKG = "pkg/#{GEM.full_name}.gem"

rum GEM.name do
  tag GEM.version

  env :RUBY_VERSION => ENV["RUBY_VERSION"] || "latest"

  stage :install
  stage :test  => :install
  stage :build => :test

  artifact PKG => :build

  desc "Push `#{PKG}` to rubygems.org"
  task :push => PKG do
    sh "gem", "push", PKG
  end

  default PKG
end
